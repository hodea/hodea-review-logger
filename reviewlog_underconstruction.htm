<meta charset="UTF-8">
<meta version="0.11">
<head>
<style>
a.nav:link {color: black; text-decoration: none; }
a.nav:visited {color: black; text-decoration: none; }
a.nav:hover {color: red; text-decoration: none; }
a.nav:active {color: black; } 

body{font-family:"Trebuchet MS", Helvetica, sans-serif}
table.reviewtable th { border:1px solid #000000; padding:5px;}
table.reviewtable tr, td { padding:5px;}        

table.reviewtable tr:hover {color: white; background-color: #1E90FF}

</style>
</head>
<html>
<script type="text/javascript">


var myJSONObject = {
"overview": [
{
"iclosed": 9,
"icomment": 0,
"imajor": 1,
"iminor": 13,
"iopen": 0,
"irejected": 5,
"iundefined": 0
}
],
"reviewitem": [
{
"ID": "0",
"closedate": "30/12/2015",
"comments": "nix is hier</br>richtig</br>blablba",
"filepath": "drv_uart.c",
"opendate": "30/12/2015",
"severity": "Minor",
"status": "Rejected"
},
{
"ID": "1",
"closedate": "30/12/2015",
"comments": "Bootloading on primary currently disabled</br>neu",
"filepath": "drv_module_config.h",
"opendate": "30/12/2015",
"severity": "Minor",
"status": "Rejected"
},
{
"ID": "2",
"closedate": "30/12/2015",
"comments": "blabla",
"filepath": "drv_module_config.h",
"opendate": "30/12/2015",
"severity": "Minor",
"status": "Closed"
},
{
"ID": "3",
"closedate": "30/12/2015",
"comments": "Bootloading on primary currently disabled</br>neuer kommentar</br>closed",
"filepath": "test.txt",
"opendate": "30/12/2015",
"severity": "Minor",
"status": "Closed"
},
{
"ID": "4",
"closedate": "30/12/2015",
"comments": "Bootloading on primary currently disabled</br>test test</br>test</br>test</br>test",
"filepath": "test.txt",
"opendate": "30/12/2015",
"severity": "Minor",
"status": "Closed"
},
{
"ID": "5",
"closedate": "30/12/2015",
"comments": "Bootloading on primary currently disabled</br>test test</br>test</br>test</br>test",
"filepath": "test.txt",
"opendate": "30/12/2015",
"severity": "Minor",
"status": "Closed"
},
{
"ID": "6",
"closedate": "30/12/2015",
"comments": "Bootloading on primary currently disabled</br>test test</br>test</br>test</br>test",
"filepath": "test.txt",
"opendate": "30/12/2015",
"severity": "Minor",
"status": "Closed"
},
{
"ID": "7",
"closedate": "30/12/2015",
"comments": "Bootloading on primary currently disabled</br>test test</br>test</br>test</br>test",
"filepath": "test.txt",
"opendate": "30/12/2015",
"severity": "Minor",
"status": "Closed"
},
{
"ID": "8",
"closedate": "30/12/2015",
"comments": "Bootloading on primary currently disabled</br>test test</br>test</br>test</br>test",
"filepath": "test.txt",
"opendate": "30/12/2015",
"severity": "Minor",
"status": "Rejected"
},
{
"ID": "9",
"closedate": "30/12/2015",
"comments": "Bootloading on primary currently disabled</br>test test</br>test</br>test</br>test",
"filepath": "test.txt",
"opendate": "30/12/2015",
"severity": "Minor",
"status": "Rejected"
},
{
"ID": "10",
"closedate": "30/12/2015",
"comments": "Bootloading on primary currently disabled</br>test test</br>test</br>test</br>test",
"filepath": "test.txt",
"opendate": "30/12/2015",
"severity": "Minor",
"status": "Closed"
},
{
"ID": "11",
"closedate": "30/12/2015",
"comments": "Bootloading on primary currently disabled</br>test test</br>test</br>test</br>test",
"filepath": "test.txt",
"opendate": "30/12/2015",
"severity": "Minor",
"status": "Rejected"
},
{
"ID": "12",
"closedate": "30/12/2015",
"comments": "Bootloading on primary currently disabled</br>test test</br>test</br>test</br>test",
"filepath": "test.txt",
"opendate": "30/12/2015",
"severity": "Minor",
"status": "Closed"
},
{
"ID": "13",
"closedate": "30/12/2015",
"comments": "blabla</br>neuer comment</br>noch mehr",
"filepath": "drv_module_config.h",
"opendate": "30/12/2015",
"severity": "Major",
"status": "Closed"
}
]
}
//@JSON-END-internal variables
var sortID = 0;
var sortstatus = 1;
var sortdate = 0;
var sortclosedate = 0;
var sortseverity = 0;
var sortfilepath = 0;
var sortcomments = 0;
var j = 0;

var buttonhandler = [false,true,false];

</script>
<body>
<button type="button" onclick="href:javascript:printoverview('expand')">Overview</button>
<button type="button" onclick="href:javascript:sort('expand')">Issue Log</button>
<button type="button">File Log</button>
<script type="text/javascript">
document.write('<div id="overviewdiv">')
document.write('</div>')
document.write('<div id="tablediv">')
document.write('</div>')


function sort(order)
{
    
	if(order == 'minimize')
	{
		printheader();
		return;
	}
	printoverview('minimize');
    if(order == 'ID')
    {
        if(sortID)
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((Number(b.ID) < Number(a.ID)) ? -1 : ((Number(a.ID) == Number(b.ID)) ? 0 : 1));
            });
            sortID = false;
        }
        else
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((Number(a.ID) < Number(b.ID)) ? -1 : ((Number(a.ID) == Number(b.ID)) ? 0 : 1));
            });
            sortID = true;
        }
    }
    else if(order == 'filepath')
    {
        if(sortfilepath)
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((b.filepath < a.filepath) ? -1 : ((a.filepath == b.filepath) ? 0 : 1));
            });
            sortfilepath = false;
        }
        else
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((a.filepath < b.filepath) ? -1 : ((a.filepath == b.filepath) ? 0 : 1));
            });
            sortfilepath = true;
        }
    }
    else if(order == 'status')
    {
        if(sortstatus)
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((Number(b.gloablsevstatus) < Number(a.gloablsevstatus)) ? -1 : ((Number(a.gloablsevstatus) == Number(b.gloablsevstatus)) ? 0 : 1));
            });
            sortstatus = false;
        }
        else
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((Number(a.gloablsevstatus) < Number(b.gloablsevstatus)) ? -1 : ((Number(a.gloablsevstatus) == Number(b.gloablsevstatus)) ? 0 : 1));
            });
            sortstatus = true;
        }

    }
    else if(order == 'opendate')
    {
        if(sortdate)
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((b.opendate < a.opendate) ? -1 : ((a.opendate == b.opendate) ? 0 : 1));
            });
            sortdate = false;
        }
        else
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((a.opendate < b.opendate) ? -1 : ((a.opendate == b.opendate) ? 0 : 1));
            });
            sortdate = true;
        }
    }
    else if(order == 'closedate')
    {
        if(sortclosedate)
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((b.closedate < a.closedate) ? -1 : ((a.closedate == b.closedate) ? 0 : 1));
            });
            sortclosedate = false;
        }
        else
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((a.closedate < b.closedate) ? -1 : ((a.closedate == b.closedate) ? 0 : 1));
            });
            sortclosedate = true;
        }
    }
    else if(order == 'severity')
    {
        if(sortseverity)
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((Number(b.gloablsevseverity) < Number(a.gloablsevseverity)) ? -1 : ((Number(a.gloablsevseverity) == Number(b.gloablsevseverity)) ? 0 : 1));
            });
            sortseverity = false;
        }
        else
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((Number(a.gloablsevseverity) < Number(b.gloablsevseverity)) ? -1 : ((Number(a.gloablsevseverity) == Number(b.gloablsevseverity)) ? 0 : 1));
            });
            sortseverity = true;
        }
    }
    else if(order == 'comments')
    {
        if(sortcomments)
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((b.comments < a.comments) ? -1 : ((a.comments == b.comments) ? 0 : 1));
            });
            sortcomments = false;
        }
        else
        {
            myJSONObject.reviewitem.sort(function(a, b) {
                return ((a.comments < b.comments) ? -1 : ((a.comments == b.comments) ? 0 : 1));
            });
            sortcomments = true;
        }
    }
    printtable();
}
function printtable()
{
    newtable = '<table id="reviewtable" class="reviewtable" cellpadding="0" cellspacing="1" border="0" width="1100" style="padding-top:50px;font-size:10pt">'  
    newtable = newtable + '<tr>'
    newtable = newtable + '<th width="75"><a href="javascript:sort(\'ID\')" class="nav">ID</a></th>'
    newtable = newtable + '<th width="1%"><a href="javascript:sort(\'filepath\')" class="nav">File</a></th>'
    newtable = newtable + '<th width="60"><a href="javascript:sort(\'status\')" class="nav">Status</a></th>'
    newtable = newtable + '<th width="100"><a href="javascript:sort(\'opendate\')" class="nav">Open date</a></th>'
    newtable = newtable + '<th width="100"><a href="javascript:sort(\'closedate\')" class="nav">Close date</a></th>'
    newtable = newtable + '<th width="100"><a href="javascript:sort(\'severity\')" class="nav">Severity</a></th>'
    newtable = newtable + '<th><a href="javascript:sort(\'comments\')" class="nav">Comments</a></th><tr>' 
    for(i=0;i<myJSONObject.reviewitem.length;i++)
    {
        if(i%2 == 0)
        {
            newtable = newtable + '<tr bgcolor="#EFEFEF"><td align="center">' + myJSONObject.reviewitem[i].ID.split('___')[0] + '</td>'
        } 
        else
        {
            newtable = newtable + '<tr bgcolor="#FCFCFC"><td align="center">' + myJSONObject.reviewitem[i].ID.split('___')[0] + '</td>'
        }
            newtable = newtable + '<td align="center">' + myJSONObject.reviewitem[i].filepath + '</td>' 
            newtable = newtable + '<td align="center">' + myJSONObject.reviewitem[i].status + '</td>' 
            newtable = newtable + '<td align="center">' + myJSONObject.reviewitem[i].opendate + '</td>'  
            newtable = newtable + '<td align="center">' + myJSONObject.reviewitem[i].closedate + '</td>' 
            newtable = newtable + '<td align="center">' + myJSONObject.reviewitem[i].severity + '</td>' 
            if(myJSONObject.reviewitem[i].comments.split("</br>").length > 1)
            { 
                newtable = newtable + '<td><a id="commentlinker'+i+'" class="nav">' + myJSONObject.reviewitem[i].comments.split("</br>")[0] + '</a></td></div></tr>'
            }
            else
            {
                newtable = newtable + '<td><a class="navnolink">' + myJSONObject.reviewitem[i].comments.split("</br>")[0] + '</a></td></div></tr>'
            }
    }
    newtable = newtable + '</table>'
    document.getElementById('tablediv').innerHTML=newtable;


    
    for(i=0;i<myJSONObject.reviewitem.length;i++)
    {
        if(myJSONObject.reviewitem[i].comments.split("</br>").length > 1)
        {
            document.getElementById("commentlinker"+i).addEventListener("click", (function(j) {
                return function(e) {
                if(document.getElementById("commentlinker"+j).innerHTML == myJSONObject.reviewitem[j].comments.split("</br>")[0])
                {
                        document.getElementById("commentlinker"+j).innerHTML = myJSONObject.reviewitem[j].comments;
                }
                else
                {
                    document.getElementById("commentlinker"+j).innerHTML = myJSONObject.reviewitem[j].comments.split("</br>")[0]
                }
                e.preventDefault();
                }
            })(i));
        }
    }
}
function printheader()
{   
    newtable = ''    
    document.getElementById('tablediv').innerHTML=newtable;
}
function printoverview(order)
{
    var totalnumber = myJSONObject.overview[0].iopen+myJSONObject.overview[0].iclosed+myJSONObject.overview[0].irejected
	newoverview = ''
    if(order == 'expand')
    {
		sort('minimize');
        newoverview = '<table cellpadding="0" cellspacing="0" border="0" width="800" style="padding-top:50px;font-size:10pt"><tr><td>'
        newoverview = newoverview + '<table cellpadding="0" cellspacing="0" border="0" width="200" style="font-size:10pt">'
        newoverview = newoverview + '<tr><td width="150">Open</td>'
        newoverview = newoverview + '<td>' + myJSONObject.overview[0].iopen + '</td>'
        newoverview = newoverview + '</tr><tr>'
        newoverview = newoverview + '<td>Rejected</td>'
        newoverview = newoverview + '<td>' + myJSONObject.overview[0].irejected + '</td>'
        newoverview = newoverview + '</tr><tr>'
        newoverview = newoverview + '<td>Closed</td>'
        newoverview = newoverview + '<td>' + myJSONObject.overview[0].iclosed + '</td>'
        newoverview = newoverview + '</tr></table></td><td>'
        newoverview = newoverview + '<table cellpadding="0" cellspacing="0" border="0" width="600" height ="20">'
        newoverview = newoverview + '<tr>' 
        if(myJSONObject.overview[0].iopen > 0){
            newoverview = newoverview + '<td style="width:' + (100*myJSONObject.overview[0].iopen)/(totalnumber) +'%" bgcolor="#F76C6C"></td>'
        }if(myJSONObject.overview[0].irejected > 0){
            newoverview = newoverview + '<td style="width:' + (100*myJSONObject.overview[0].irejected)/(totalnumber) + '%" bgcolor="#b2ff00"></td>'
        }if(myJSONObject.overview[0].iclosed > 0){
            newoverview = newoverview + '<td style="width:' + (100*myJSONObject.overview[0].iclosed)/(totalnumber) + '%" bgcolor="#7ACC57"></td>'
        }   
              
        newoverview = newoverview + '</tr></table></td></tr></table>'
        newoverview = newoverview + '<table cellpadding="0" cellspacing="0" border="0" width="800" height="20" style="padding-top:50px">'
        newoverview = newoverview + '<tr><td>'
        newoverview = newoverview + '<table cellpadding="0" cellspacing="0" border="0" width="200" style="font-size:10pt">'
        newoverview = newoverview + '<tr><td width="150">Major</td>'
        newoverview = newoverview + '<td>' + myJSONObject.overview[0].imajor + '</td>'            
        newoverview = newoverview + '</tr><tr><td>Minor</td>'
        newoverview = newoverview + '<td>' + myJSONObject.overview[0].iminor + '</td>'            
        newoverview = newoverview + '</tr><tr><td>Comments</td>'
        newoverview = newoverview + '<td>' + myJSONObject.overview[0].icomment + '</td>'            
        newoverview = newoverview + '</tr><tr><td>Undefined</td>'
        newoverview = newoverview + '<td>' + myJSONObject.overview[0].iundefined + '</td>'            
        newoverview = newoverview + '</tr></table></td>'
        newoverview = newoverview + '<td><table cellpadding="0" cellspacing="0" border="0" width="600" height="20" >'
        newoverview = newoverview + '<tr>'
        if(myJSONObject.overview[0].imajor > 0){    
            newoverview = newoverview + '<td style="width:' + (100*myJSONObject.overview[0].imajor)/(totalnumber) +'%" bgcolor="#F76C6C"></td>'
        }if(myJSONObject.overview[0].iminor > 0){
            newoverview = newoverview + '<td style="width:' + (100*myJSONObject.overview[0].iminor)/(totalnumber) + '%" bgcolor="#FFEC5E"></td>'
        }if(myJSONObject.overview[0].icomment > 0){
            newoverview = newoverview + '<td style="width:' + (100*myJSONObject.overview[0].icomment)/(totalnumber) + '%" bgcolor="#7ACC57"></td>'
        }if(myJSONObject.overview[0].iundefined > 0){
            newoverview = newoverview + '<td style="width:' + (100*myJSONObject.overview[0].iundefined)/(totalnumber) + '%" bgcolor="#e5e5e5"></td>'
        }        
        newoverview = newoverview + '</tr></table></td></tr></table>' 
    }


    document.getElementById('overviewdiv').innerHTML=newoverview;
}

function calcglobalseverity()
{
    var a,b;
    for(i=0;i<myJSONObject.reviewitem.length;i++)
    {
        if(myJSONObject.reviewitem[i].severity == 'Major') a = 4;
        else if(myJSONObject.reviewitem[i].severity == 'Minor') a = 3;
        else if(myJSONObject.reviewitem[i].severity == 'Comment') a = 2;
        else a = 1;
        
        if(myJSONObject.reviewitem[i].status == 'Open') b = 21;
        else if(myJSONObject.reviewitem[i].status == 'Rejected') b = 5;
        else b = 1;
        
        myJSONObject.reviewitem[i].gloablsevstatus = a * b;
        
        
        if(myJSONObject.reviewitem[i].severity == 'Major') a = 40;
        else if(myJSONObject.reviewitem[i].severity == 'Minor') a = 13;
        else if(myJSONObject.reviewitem[i].severity == 'Comment') a = 4;
        else a = 1;
        
        if(myJSONObject.reviewitem[i].status == 'Open') b = 3;
        else if(myJSONObject.reviewitem[i].status == 'Rejected') b = 2;
        else b = 1;
        
        myJSONObject.reviewitem[i].gloablsevseverity = a * b;
    }
    
}

function printfilelog(order)
{

}


//calcglobalseverity();
sort('status');
sort('minimize');


</script>

</body>
</html>